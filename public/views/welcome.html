{{ define "welcome" }}

<!DOCTYPE html>
<html lang="en">
	{{ template "header" .}}

	<body>
		<main class="main">
			<div class="container logo">
				<img src="public/assets/images/logo.gif" alt="scribble logo" />
			</div>

			{{ if .RenderCreateRoomForm }}

			<div class="form-container">
				<form action="/create-room" method="post">
					<div class="form-content-grid">
						{{ range .FormParams }}
						<div>
							<div class="form-image-and-label" title="{{.Desc}}">
								<img
									src="public/assets/images/setting_{{.ImgIdx}}.gif"
									alt=""
								/>
								<label for="{{.ID}}">{{.Label}}</label>
							</div>
							<div class="form-select-container">
								<select id="{{.ID}}" name="{{.ID}}">
									{{ range .Options }} {{ if .Selected }}
									<option value="{{.Value}}" selected>{{.Label}}</option>
									{{ else }}
									<option value="{{.Value}}">{{.Label}}</option>
									{{ end }} {{ end }}
								</select>
							</div>
						</div>
						{{ end }}
					</div>

					<div class="custom-words-container">
						<div>
							<label for="customWords">Custom words</label>

							<div class="input-checkbox-container">
								<label for="useCustomWordsOnly">Use custom words only</label>
								<input
									type="checkbox"
									name="useCustomWordsOnly"
									id="useCustomWordsOnly"
								/>
							</div>
						</div>
						<div>
							<textarea
								name="customWords"
								id="customWords"
								maxlength="20000"
								spellcheck="false"
								placeholder="Minimum of 10 words. 1-32 characters per word! 20000 characters maximum. Separated by a , (comma)"
							></textarea>
						</div>
					</div>

					<div class="form-btn-container">
						<button class="btn create-room-btn" type="submit">
							Create room
						</button>
					</div>
				</form>

				{{ if .RoomCreated }}

				<div class="room-created-container">
					<div>
						<a href="{{ .Link }}" class="link"
							><button class="btn join-room-btn">Click here to join!</button></a
						>
					</div>

					<div title="Copy joining link">
						<button class="btn btni copy-link-btn">
							<div>
								<div>
									<span>Copy link</span>
								</div>

								<div class="img-container">
									<img
										src="public/assets/images/setting_0.gif"
										alt="copy icon"
										class="copy-link-img"
									/>
								</div>
							</div>
						</button>
					</div>
				</div>

				<script>
					// copy to clipboard
					const aTag = document.querySelector('.link');
					document
						.querySelector('.copy-link-btn')
						.addEventListener('click', () =>
							navigator.clipboard.writeText(aTag.href)
						);

					// disable create btn
					document.querySelector('.create-room-btn').disabled = true;

					// populate input fields
					document.getElementById('players').value = '{{ .Players }}';
					document.getElementById('drawTime').value = '{{ .DrawTime }}';
					document.getElementById('rounds').value = '{{ .Rounds }}';
					document.getElementById('wordCount').value = '{{ .WordCount }}';
					document.getElementById('hints').value = '{{ .Hints }}';
					document.getElementById('wordMode').value = '{{ .WordMode }}';
					document.getElementById('customWords').value = '{{ .CustomWords }}';
					document.getElementById('useCustomWordsOnly').checked =
						'{{ .UseCustomWordsOnly }}' === 'true';
				</script>

				{{ end }}
			</div>

			{{ else }}

			<div class="container start">
				<div>
					<input
						type="text"
						name="ownerName"
						class="ownerName"
						id="ownerName"
						maxlength="15"
						placeholder="Enter your name"
					/>
				</div>

				<div class="avatar-customisable">
					<div class="avc-lb-container">
						<div class="avc-btn eyes-left"></div>
						<div class="avc-btn mouth-left"></div>
						<div class="avc-btn color-left"></div>
					</div>

					<div class="avatar">
						<div class="color"></div>
						<div class="eyes"></div>
						<div class="mouth"></div>
						<div class="special"></div>
						<div class="owner"></div>
					</div>

					<div class="avc-rb-container">
						<div class="avc-btn eyes-right"></div>
						<div class="avc-btn mouth-right"></div>
						<div class="avc-btn color-right"></div>
					</div>

					<div class="randomize"></div>
				</div>

				<div>
					<a href="/create-room"
						><button class="btn play">Create private room</button></a
					>
				</div>

				<script src="public/javascript/welcome.js"></script>
			</div>

			{{ end }}

			<div class="container about">
				<div class="title">
					<div class="title-image-container">
						<img src="public/assets/images/about.gif" alt="about" />
					</div>
					<h2 class="title-text">About</h2>
				</div>

				<div class="subtext">
					{{ range .AboutText }}
					<p>{{ . }}</p>
					<br />
					{{ end }}
					<p>Have fun!</p>
				</div>
			</div>

			<div class="container how-to-play">
				<div class="title">
					<div class="title-image-container">
						<img src="public/assets/images/how.gif" alt="how to play" />
					</div>
					<h2 class="title-text">How to play</h2>
				</div>

				<div class="slideshow-container">
					{{ range $i, $val := .HowToSlides }}
					<div class="slides fade">
						<img src="public/assets/images/tutorial/step{{$i}}.gif" />
						<p>{{ $val }}</p>
					</div>
					{{ end }}
				</div>
				<br />

				<div class="dot-container">
					{{ range $id, $val := .HowToSlides }}
					<span class="dot" id="dot_{{$id}}"></span>
					{{ end }}
				</div>

				<script>
					// how to play slideshow

					let slideIndex = 0;

					const slides = document.getElementsByClassName('slides');
					const dots = document.getElementsByClassName('dot');

					showSlides();

					for (let i = 0; i < dots.length; i++) {
						dots[i].addEventListener('click', e => {
							const id = e.currentTarget.id;
							slideIndex = +id.slice(id.length - 1);

							showCurrSlide(slideIndex);
						});
					}

					function showCurrSlide(idx) {
						for (let i = 0; i < slides.length; i++) {
							slides[i].style.display = 'none';
							dots[i].classList.remove('active');
						}

						slides[idx].style.display = 'block';
						dots[idx].classList.add('active');
					}

					function showSlides() {
						showCurrSlide(slideIndex);

						slideIndex += 1;
						if (slideIndex >= slides.length) slideIndex = 0;

						setTimeout(showSlides, 2500);
					}
				</script>
			</div>
		</main>

		{{ if .debug }}
		<script>
			document.querySelector('.link') &&
				(document.querySelector('.link').href =
					'http://localhost:1323/app?join=debug');
		</script>
		{{ end }}
	</body>
</html>

{{ end }}
