{{ define "app" }}

<!DOCTYPE html>
<html lang="en">
	{{ template "header" .}}

	<body>
		<div class="main">
			<!-- render this form when get request to /app is made, then capture form response and register to pool -->
			{{ if .RegisterToPool }}

			<div class="content">
				<div class="title"><h1>Scribble</h1></div>

				<form action="/app" method="post">
					<input type="hidden" name="poolId" value="{{ .PoolId }}" />

					<label class="form-label" for="clientName"
						>Enter your name to join:</label
					>
					<input
						type="text"
						name="clientName"
						id="clientName"
						value="p{{ .CurrentSize }}"
						required
						autofocus
					/>

					<button class="btn" type="submit">Join</button>
				</form>
			</div>

			{{ end }}

			<!-- render this form when post request to /app is made, render this form for chat msgs and then estalblish socket connection -->
			{{ if .ConnectSocket }}

			<div class="game-content">
				<!-- status bar -->
				<div class="status-bar">
					<!-- round details -->
					<div class="round"><span class="round-details">Round: 1</span></div>

					<!-- time left for word -->
					<div class="time-left-for-word"><span>Waiting</span></div>

					<!-- letters in word/status -->
					<div class="word"><span>_ _ _ _ _ _</span></div>

					<!-- joining link -->
					<div class="joining-link-div">
						<button class="btn joining-link">Copy joining link</button>
					</div>
				</div>

				<!-- canvas -->
				<div class="canvas-container">
					<canvas class="canv"></canvas>

					<!-- painter utils -->
					<div class="hidden painter-utils">
						<button class="btn clear-canvas">Clear</button>
					</div>
				</div>

				<div class="container">
					<!-- members in pool -->
					<div class="side members"></div>

					<!-- messages -->
					<div class="side messages"></div>
				</div>

				<!-- chat box -->
				<form>
					<input
						type="text"
						class="msg"
						placeholder="Type your guess here"
						required
					/>

					<button class="btn send-msg">Send</button>
				</form>

				<!-- score board -->
				<div class="score-board"></div>

				<div class="start-game">
					<div>
						Waiting for others to join, starting game in
						<span class="loading">{{ .GameStartDurationInSeconds }}</span>
						seconds
					</div>
					<button class="btn start-game-btn">Start now</button>
				</div>

				<script>
					const poolId = '{{ .PoolId }}';
					const clientId = '{{ .ClientId }}';
					const clientName = '{{ .ClientName }}';
					const clientColor = '{{ .ClientColor }}';
					const gameStartTime = new Date('{{ .GameStartTime }}').getTime();

					const joiningLink = '{{ .JoiningLink }}';
				</script>

				<script src="public/javascript/utils.js"></script>
				<script src="public/javascript/canvas.js"></script>
				<script src="public/javascript/socket.js"></script>
				<script src="public/javascript/main.js"></script>
				<script src="public/javascript/startGame.js"></script>
			</div>

			{{ end }}

			<!-- if pool does not exist or some error occurs then render message only, render this part when .Message is not "empty" -->
			{{ if ne .Message "" }}

			<div class="content">
				<p>{{ .Message }}</p>
			</div>

			{{ end }}
		</div>
	</body>
</html>

{{ end }}
